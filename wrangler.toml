# Cloudflare Pages configuration
name = "getlifesorted"
compatibility_date = "2023-10-30"
compatibility_flags = ["nodejs_compat"]
pages_build_output_dir = "dist"

# Build configuration
[build]
command = "npm run build"

# Environment variables
# Moving vars to environment-specific sections

# Production environment
[env.production]
vars = { NODE_VERSION = "22" }
# Add production-specific variables here if needed
# MY_VAR = "production-value"

# Preview environment (for pull requests)
[env.preview]
vars = { NODE_VERSION = "22" }
# Add preview-specific variables here if needed
# MY_VAR = "preview-value"

# Routes configuration - changed to array format
[[routes]]
# Force HTTPS
pattern = "http://*"
script = """
  addEventListener('fetch', event => {
    event.respondWith(
      Response.redirect('https://' + event.request.url.slice(7), 301)
    )
  })
"""

# Cache configuration
# Using rules array for cache configuration
[[rules]]
pattern = "/assets/*"
ttl = 31536000

[[rules]]
pattern = "/images/*"
ttl = 604800

[[rules]]
pattern = "/*.html"
ttl = 0
